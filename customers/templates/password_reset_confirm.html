{% extends 'base.html' %}

{% block content %}
<div class="content">
  <div class="container mt-5">
    <div class="row justify-content-center">
      <div class="col-md-6">
        <h2 class="text-center mb-4">Set a New Password</h2>

        <form method="post" novalidate>
          {% csrf_token %}

          {# Nonâ€‘field errors #}
          {% if form.non_field_errors %}
          <div class="alert alert-danger">
            {% for err in form.non_field_errors %}
              <div>{{ err }}</div>
            {% endfor %}
          </div>
          {% endif %}

          <div class="mb-3">
            {{ form.new_password1.label_tag }}
            <input
              type="password"
              class="form-control"
              id="id_new_password1"
              name="{{ form.new_password1.name }}"
              placeholder="Enter new password"
              required
            >
            {% for error in form.new_password1.errors %}
              <div class="text-danger small">{{ error }}</div>
            {% endfor %}
          </div>

          <div class="mb-3">
            {{ form.new_password2.label_tag }}
            <input
              type="password"
              class="form-control"
              id="id_new_password2"
              name="{{ form.new_password2.name }}"
              placeholder="Confirm new password"
              required
            >
            {% for error in form.new_password2.errors %}
              <div class="text-danger small">{{ error }}</div>
            {% endfor %}
          </div>

          <!-- Show/Hide toggle, positioned below both fields -->
          <div class="form-check mb-3">
            <input
              class="form-check-input"
              type="checkbox"
              id="showPasswordToggle"
            >
            <label class="form-check-label" for="showPasswordToggle">
              Show password
            </label>
          </div>

          <div class="d-grid gap-2">
            <button type="submit" class="btn btn-primary btn-lg">
              Change Password
            </button>
          </div>
        </form>

        <!-- Back to Login link -->
        <div class="text-center mt-3">
          <a href="{% url 'login' %}">&larr; Back to Login</a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Inline JS for Show/Hide all password fields -->
<script>
  document.getElementById('showPasswordToggle').addEventListener('change', function() {
    const p1 = document.getElementById('id_new_password1');
    const p2 = document.getElementById('id_new_password2');
    const type = this.checked ? 'text' : 'password';
    p1.type = p2.type = type;
  });
</script>
{% endblock %}
